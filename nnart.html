<h1>CS194 Final Project: A Neural Algorithm of Artistic Style
    <br>
    <b>April Sin</b>
</h1>

<h2>Overview</h2>
<p>We will be reimplementing <a href="https://arxiv.org/pdf/1508.06576.pdf">this paper</a>. The basic idea it to
    use convolutional neural networks to extract
    the art style from one image (the style image) and transfer it to another (the content image).</p>

<h2>My style transfer model</h2>
<h3>Algorithm</h3>
<p>Following the algorithm in the paper, I used ImageNet's pretrained VGG19 model availabe
    from <code>PyTorch</code> (see <a
        href="https://pytorch.org/docs/stable/torchvision/models.html"><code>torchvision.models</code></a>) as
    the base model. Then create a wrapper model on top of it for the style transfer.
</p>

<p>I used the basic Adam optimizer and the loss function from the paper.</p>
<p>The loss function is: $$Loss_{total} = weight_{content} * Loss_{content} + weight_{style} *
    Loss_{style}$$</p>

<h3>Hyper-parameters</h3>
<p>I experimented with a series of combinations for {content_weight, style_weight, num_epochs, learning_rate}.
</p>
<p>In the paper, the researchers got best results when using <code>style_weight = 1e4</code>. However, I got
    best results with <code>style_weight = 1e6</code> <br>(consider <code>content_weight = 1). </code></p>
<p>I thought I would need to train for very long, but after a few 100 epochs, the results were actually pretty
    good already. I ended up with <code>num_epochs = 1000</code>, it seems to give a balance between content and
    style. And a
    larger learning rate seems
    to help too.</p>



<h4>Inputs:</h4>
<div class="row">
    <div class="column">
        <img style="margin-top: 50px" src="kitty.jpg" alt="content" />
        <figcaption>Content Image
        </figcaption>
    </div>
    <div class="column">
        <img src="starry.jpg" alt="style" />
        <figcaption>Style Image</figcaption>
    </div>
</div>

<b>Results:</b>
<div class="row">
    <div class="column_5">
        <img src="kitty-starry-sw=100.0-ne=1000-lr=0.01_resized.jpg" />
        <figcaption><code>style_weight=100.0, num_epochs=1000, learn_rate=0.01</code>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=1000.0-ne=1000-lr=0.01_resized.jpg" />
        <figcaption><code>style_weight=1000.0, num_epochs=1000, learn_rate=0.01</code>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=10000.0-ne=1000-lr=0.01_resized.jpg" />
        <figcaption><code>style_weight=10000.0, num_epochs=1000, learn_rate=0.01</code>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=100000.0-ne=1000-lr=0.01_resized.jpg" />
        <figcaption><code>style_weight=10000.0, num_epochs=1000, learn_rate=0.01</code>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=1000000.0-ne=1000-lr=0.01_resized.jpg" />
        <figcaption><code>style_weight=10000.0, num_epochs=1000, learn_rate=0.01</code>
        </figcaption>
    </div>
</div>
<div class="row">
    <div class="column_5">
        <img src="kitty-starry-sw=100.0-ne=1000-lr=0.005_resized.jpg" />
        <figcaption><code>style_weight=100.0, num_epochs=1000, learn_rate=0.005</code>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=1000.0-ne=1000-lr=0.005_resized.jpg" />
        <figcaption><code>style_weight=1000.0, num_epochs=1000, learn_rate=0.005</code>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=10000.0-ne=1000-lr=0.005_resized.jpg" />
        <figcaption><code>style_weight=10000.0, num_epochs=1000, learn_rate=0.005</code>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=100000.0-ne=1000-lr=0.005_resized.jpg" />
        <figcaption><code>style_weight=10000.0, num_epochs=1000, learn_rate=0.005</code>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=1000000.0-ne=1000-lr=0.005_resized.jpg" />
        <figcaption><code>style_weight=10000.0, num_epochs=1000, learn_rate=0.005</code>
        </figcaption>
    </div>
</div>
<div class="row">
    <div class="column_5">
        <img src="kitty-starry-sw=100.0-ne=1000-lr=0.001_resized.jpg" />
        <figcaption><code>style_weight=100.0, num_epochs=1000, learn_rate=0.001</code>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=1000.0-ne=1000-lr=0.001_resized.jpg" />
        <figcaption><code>style_weight=1000.0, num_epochs=1000, learn_rate=0.001</code>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=10000.0-ne=1000-lr=0.001_resized.jpg" />
        <figcaption><code>style_weight=10000.0, num_epochs=1000, learn_rate=0.001</code>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=100000.0-ne=1000-lr=0.001_resized.jpg" />
        <figcaption><code>style_weight=10000.0, num_epochs=1000, learn_rate=0.001</code>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=1000000.0-ne=1000-lr=0.001_resized.jpg" />
        <figcaption><code>style_weight=10000.0, num_epochs=1000, learn_rate=0.001</code>
        </figcaption>
    </div>
</div>

<h2>Personal Favourites (i.e more pretty picutures Ｏ(≧▽≦)Ｏ)</h2>
<p></p>
<div class="row">
    <div class="column_5">
        <img class="fix-height" src="starry.jpg" />
        <figcaption>Starry Night ✨ <i> (Van Gogh) </i>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-starry-sw=100000.0-ne=1000-lr=0.01_resized.jpg" />
        <figcaption><code>style_weight=10000.0, num_epochs=1000, learn_rate=0.01</code>
        </figcaption>
    </div>
</div>
<div class="row">
    <div class="column_5">
        <img class="fix-height" src="tsunami.jpg" />
        <figcaption>The Great Wave off Kanagawa 神奈川沖浪裏 <br><i> (Katsushika Hokusai 葛飾 北斎) </i>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-tsunami-sw=100000.0-ne=1000-lr=0.005_resized.jpg" />
        <figcaption><code>style_weight=10000.0, num_epochs=1000, learn_rate=0.005</code>
        </figcaption>
    </div>
</div>
<div class="row">
    <div class="column_5">
        <img class="fix-height" src="rain-princess.jpg" />
        <figcaption>Rain Pricess <i> (Leonid Afremov)</i>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-rain-princess-sw=1000000.0-ne=1000-lr=0.01_resized.jpg" />
        <figcaption><code>style_weight=1000000.0, num_epochs=1000, learn_rate=0.01</code>
        </figcaption>
    </div>
</div>
<div class="row">
    <div class="column_5">
        <img class="fix-height" src="femme.jpg" />
        <figcaption>Seated Nude, 1909 <i>(Picasso)</i>
        </figcaption>
    </div>
    <div class="column_5">
        <img src="kitty-femme-sw=100000.0-ne=1000-lr=0.01_resized.jpg" />
        <figcaption><code>style_weight=10000.0, num_epochs=1000, learn_rate=0.01</code>
        </figcaption>
    </div>
</div>
</body>
